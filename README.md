# PTT C_CHAT網路爬蟲-2019年動畫票數統計
從PTT C_CHAT版文章 "[推投] 2019年最喜歡的電視動畫 「4票」"中，擷取文章中動畫代碼、名稱以及推文中用戶之投票內容。

動畫標題(部分)如下:

![cchat1](/readme/PTT_CCHAT動畫標題.PNG)

推文投票(部分)如下:

![cchat2](/readme/PTT_CCHAT推文投票.PNG)

## 爬蟲、資料擷取整理之困難
### 文章**主體**部分


原始碼擷取(部分)如下:

![cchat3](/readme/文章主體原始碼.PNG)

1. 動畫標題的部分並全部歸類於<div id="main-container">下，於剖析時須特別注意內文之分割。
2. 動畫標題之編號因其表達為"1@"格式，於原始碼中自動分辨為E-mail格式，並且被自動屏蔽，無法直接判斷，故需另外解碼。
3. 對比內文與原始碼可發現，動畫標題順序於文章中為由上至下，而於原始碼中順序為由左至右，整理後須另行排序。
4. 動畫名稱可能包含中、英文、數字、空格及特殊符號等，且無一定規律，故須特別注意

  

### 文章**推文**部分

![cchat4](/readme/文章推文原始碼.PNG)

1. 推文以"1@"格式皆自動分辨為E-mail格式，並且被自動屏蔽，無法直接判斷，故需另外解碼。
2. 每位用戶並未皆投滿4票，且遵守統一格式，故需單獨擷取純數字部分。

  用戶dnek之推文內容為"7@32@63@106@"，如下圖
  ![cchat2](/readme/PTT_CCHAT推文投票.PNG)
  
  因"@"間無空格，系統自動判斷為2個E-mail格式而非4個，如下圖
  ![cchat5](/readme/dnek_email_protect.PNG)
  
  經處理後依然擷取出正確之票數如下圖
  ![cchat6](/readme/dnek_extract.PNG)
  
## 2019年動畫票數統計
將推文內容，如"1@"等票數統計，對應至動畫名稱，統計出總票數並依票數高至低排序得出結果。

 ![cchat7](/readme/PTT_CCHAT推文投票結果.PNG)
 
確認計票結果後，將結果輸出為CSV檔，利用PowerBI進一步將投票結果視覺化及增加可互動性。

 ![cchat](/readme/C_CHAT票數視覺化.PNG)
